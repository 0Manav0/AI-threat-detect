{% extends "base.html" %}

{% block content %}
<div class="analytics-container">
    <h2 class="heading">Threat Analytics</h2>
    <div class="chart-wrapper">
        <canvas id="analyticsChart"></canvas>
    </div>
</div>
{% endblock %}

{% block styles %}
<style>
.analytics-container {
    max-width: 900px;
    margin: 2rem auto;
    padding: 1rem;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

.heading {
    text-align: center;
    font-size: 1.8rem;
    margin-bottom: 2rem;
    color: #222;
    border-bottom: 2px solid #eee;
    padding-bottom: 0.5rem;
}

.chart-wrapper {
    position: relative;
    width: 100%;
    min-height: 400px;
    background-color: #fff;
    padding: 1rem;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
}
</style>
{% endblock %}

{% block scripts %}
<script>
const labels = {{ timestamps|default([])|tojson }};
const dataValues = {{ values|default([])|tojson }};
const confidences = {{ confidences|default([])|tojson }};

const ctx = document.getElementById('analyticsChart').getContext('2d');
new Chart(ctx, {
    type: 'line',
    data: {
        labels: labels,
        datasets: [
            {
                label: 'Values',
                data: dataValues,
                borderColor: '#007BFF',
                backgroundColor: 'rgba(0,123,255,0.1)',
                fill: true,
                tension: 0.3,
                pointRadius: 4
            },
            {
                label: 'Confidence',
                data: confidences,
                borderColor: '#dc3545',
                backgroundColor: 'rgba(220,53,69,0.1)',
                fill: true,
                tension: 0.3,
                pointRadius: 4
            }
        ]
    },
    options: {
        responsive: true,
        plugins: {
            legend: {
                position: 'top',
                labels: { font: { size: 14 } }
            },
            tooltip: {
                mode: 'index',
                intersect: false
            }
        },
        interaction: {
            mode: 'nearest',
            intersect: false
        },
        scales: {
            y: {
                beginAtZero: true,
                ticks: { font: { size: 12 } }
            },
            x: {
                ticks: { font: { size: 12 } }
            }
        }
    }
});
</script>
{% endblock %}
